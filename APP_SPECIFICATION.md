# Finpalette 앱 기능 명세서

이 문서는 Finpalette 프로젝트의 주요 기능, 사용자 흐름, 화면 구성을 구체적으로 정의합니다. `PROJECT_PLAN.md`의 상위 목표를 실제 구현 가능한 설계로 구체화하는 것을 목표로 합니다.

---

## 1. 핵심 사용자 흐름 (Core User Flow)

사용자가 앱을 사용하는 대표적인 시나리오입니다.

1.  **첫 방문 및 게스트 사용 (Guest Onboarding):**
    - **흐름:** `앱 첫 방문` → `별도 절차 없이 즉시 대시보드 사용 시작`
    - **설명:** 로그인/회원가입 과정 없이 바로 가계부 기능 사용을 시작합니다. 모든 데이터는 브라우저의 로컬 스토리지에 저장됩니다.

2.  **계정 연동 및 데이터 동기화 (Account Sync):**
    - **목표:** 여러 기기에서 게스트 모드로 사용하던 데이터를 하나의 계정으로 안전하게 통합합니다.
    - **핵심 로직:**
        1.  **로그인 시도:** 사용자가 게스트로 사용하던 기기에서 로그인을 시도합니다.
        2.  **로컬 데이터 스캔:** 로그인 성공 직후, 앱은 로컬 스토리지에 저장된 데이터(`transactions`, `categories`)를 스캔합니다.
        3.  **신규 데이터 업로드:** 로컬 데이터 중 서버 ID(`id`)가 없는 항목들을 Supabase 서버에 새로 생성(INSERT)합니다.
        4.  **ID 업데이트:** 서버로부터 생성된 데이터의 고유 ID(uuid)를 응답받아, 로컬 스토리지의 해당 항목에 ID를 업데이트하여 '동기화 완료' 상태로 만듭니다.
        5.  **서버 데이터 다운로드:** 서버에 저장된 모든 데이터를 기기로 가져옵니다.
        6.  **데이터 병합(Merge):** 기기로 가져온 서버 데이터와 로컬 스토리지의 데이터를 합칩니다. 이 시점부터 해당 기기는 서버 데이터를 기준으로 동작합니다.
    - **시나리오 예시 (데이터 충돌 방지):**
        - **상황:** 사용자가 `폰`과 `PC`에서 각각 게스트 모드로 앱을 사용.
        - **1단계 (폰):** 사용자가 `폰`에서 먼저 로그인합니다. `폰`의 로컬 데이터(A)가 서버로 업로드됩니다.
        - **2단계 (PC):** 이후 사용자가 `PC`에서 동일한 계정으로 로그인합니다.
            - `PC`의 로_컬 데이터(B)를 스캔하여 서버 ID가 없는 항목들을 서버에 업로드합니다. (데이터 B는 데이터 A와 ID가 다르므로 신규로 추가됨)
            - 서버에 이미 저장되어 있던 `폰`의 데이터(A)를 `PC`로 다운로드합니다.
            - 최종적으로 `PC`에는 A와 B가 모두 합쳐진 전체 데이터가 표시됩니다.

3.  **일상적인 내역 기록 (Daily Logging):**
    - **흐름:** `어느 화면에서든` → `플로팅 액션 버튼(+) 클릭` → `내역 입력 모달(Modal) 열림` → `정보 입력 후 저장` → `모달 닫힘` → `대시보드에 즉시 반영`
    - **설명:** 페이지 이동 없이 현재 화면 위에 모달을 띄워 사용자의 작업 흐름을 방해하지 않고 빠르게 내역을 기록합니다.

4.  **소비 현황 파악 (Reviewing):**
    - **흐름:** `대시보드 접속` → `월별 요약 확인` → `카테고리별 지출 확인` → `최근 거래 내역 스크롤`
    - **설명:** 앱 실행 시 가장 먼저 마주하는 대시보드에서 별도 조작 없이 현재 재정 상태를 파악합니다.

5.  **심층 분석 및 관리 (Analysis & Management):**
    - **흐름:** `하단 네비게이션` → `'통계' 또는 '마이' 탭 클릭` → `해당 페이지로 이동`
    - **설명:** 상세 분석이나 설정과 같은 부가 기능은 명확히 구분된 페이지에서 제공합니다.

---

## 2. 화면 구성 및 레이아웃 (Screen Composition & Layout)

### 2.1. 공통 레이아웃

모든 페이지에 일관되게 적용되는 UI 구조입니다.

-   **헤더 (Header):** 페이지 상단에 위치하며, 현재 페이지의 제목과 알림 아이콘 등을 표시합니다.
-   **콘텐츠 영역 (Main Content):** 각 페이지의 핵심 내용이 표시되는 공간입니다.
-   **하단 네비게이션 (Bottom Navigation):** 앱의 핵심 기능(`대시보드`, `통계`, `마이`) 간 빠른 **페이지 이동**을 담당합니다.
-   **플로팅 액션 버튼 (FAB):** 내역 추가 기능을 위해 화면 우하단에 항상 떠 있는 `+` 버튼입니다.

### 2.2. 페이지별 상세 기능

#### A. 대시보드 페이지 (`DashboardPage`)
-   **역할:** 앱의 메인 화면. 현재 재정 상태를 한눈에 요약하여 보여줍니다.
-   **세부 기능:**
    1.  **월별 요약 카드:** 현재 월의 총수입, 총지출, 합계 표시. 이전/다음 달 데이터 전환 기능.
    2.  **카테고리별 지출 목록:** 이번 달 지출액이 높은 순서대로 카테고리 목록 나열.
    3.  **최근 거래 내역:** '오늘', '어제', '날짜' 순으로 그룹화된 최신 거래 내역 목록.

#### B. 내역 입력 모달 (Transaction Form Modal)
-   **역할:** 수입/지출 내역을 가장 빠르고 간편하게 입력하는 인터페이스.
-   **세부 기능:**
    1.  수입/지출 선택 탭
    2.  금액 입력 필드
    3.  카테고리 선택 (클릭 시 드롭다운 또는 하단 시트 표시)
    4.  날짜 선택 (클릭 시 달력 팝업 표시)
    5.  메모 입력 필드 (선택 사항)
    6.  저장/취소 버튼

#### C. 통계 페이지 (`StatsPage`) - Phase 2
-   **역할:** 데이터를 시각화하여 사용자의 소비 습관 분석을 돕습니다.
-   **세부 기능:**
    1.  기간 선택 필터 (월별/주별)
    2.  카테고리별 지출 원형 차트
    3.  기간별 수입/지출 막대그래프

#### D. 마이페이지 (`ProfilePage`)
-   **역할:** 계정 정보, 카테고리 등 앱의 전반적인 설정을 관리합니다.
-   **세부 기능:**
    1.  프로필 정보 및 로그아웃
    2.  **카테고리 관리 메뉴:** 클릭 시 `카테고리 관리 페이지`로 이동. 이 페이지에서 카테고리 추가/수정/삭제 및 색상 지정 가능.
    3.  기타 설정 메뉴 (앱 버전, 데이터 내보내기 등)

#### E. 팔레트 관리 기능 (`ProfilePage` 내) - Phase 3
-   **역할:** 공유 가계부를 생성하고 멤버를 관리합니다.
-   **세부 기능:**
    1.  **팔레트 전환 UI:** 현재 활성화된 팔레트를 보여주고, 다른 팔레트로 전환하는 기능 (헤더 영역).
    2.  **팔레트 관리 메뉴:** 팔레트 생성, 멤버 초대/관리, 팔레트 나가기 등의 기능 제공.

---

## 3. 인터랙션 정책 (Interaction Policy)

사용자 경험의 일관성을 위해 인터랙션 방식을 다음과 같이 정의합니다.

-   **페이지 이동 (Page Navigation):**
    -   **사용 시점:** 완전히 다른 맥락의 기능으로 전환될 때 사용합니다.
    -   **예시:** 하단 네비게이션을 통한 `대시보드` ↔ `통계` ↔ `마이페이지` 간 이동. `마이페이지`에서 `카테고리 관리` 페이지로 이동.

-   **모달 (Modal):**
    -   **사용 시점:** 현재 페이지의 맥락을 유지한 채, 특정 과업(Task)을 수행해야 할 때 사용합니다. 주로 정보 입력/수정에 사용됩니다.
    -   **예시:** `+` 버튼 클릭 시 나타나는 `내역 입력 모달`, 거래 내역 클릭 시 나타나는 `내역 수정 모달`.

-   **팝업 (Popup) / 드롭다운 (Dropdown) / 하단 시트 (Bottom Sheet):**
    -   **사용 시점:** 특정 컴포넌트와 관련하여 간단한 선택지나 추가 정보를 제공할 때 사용합니다.
    -   **예시:** `날짜 선택` 시 달력 팝업, `카테고리 선택` 시 카테고리 목록 드롭다운.

---

## 4. 아이콘 정책

- **라이브러리**: `lucide-react`를 기본 아이콘 라이브러리로 사용합니다.
- **일관성**: 앱 전체에서 아이콘의 스타일(두께, 라운딩 등)이 일관되도록 `lucide-react` 내의 아이콘을 우선적으로 사용합니다.
- **커스텀 아이콘**: 필요한 아이콘이 라이브러리에 없을 경우에만 SVG 파일을 직접 프로젝트에 추가하여 사용합니다. (`agents.md` 아이콘 사용 정책 참고)